---
layout: post
title: Philips Hue App - My First Android App
---

A few months ago I got the Philips Hue starter set when it was on sale. It contains 3 programmable blubs that can do a whole range of colours and the bridge to wirelessly connect to them. Initially I was satisfied just using apps that already existed for the lights. However when getting them I initially did have some thoughts of making my own program. Despite being quite impressed with some existing apps there was still one use case that I thought I could do better.

What I wanted was to be able to turn the lights on and off with the same button on my phone. The Philips Hue app could pretty much do this except that it needs two widgets one for the scene to turn the lights on and the other for turning them off. I could also just use a normal light switch and turn the lights on and off but beside that not really being the point of those lights they happen to have a really white light as the default light (can’t be changed) which I really dislike as I prefer a much warmer light. Therefore while it isn’t anything revolutionary a one click app capable of turning lights both on and off to a prechosen colour of my choice was my goal for both my first Android and Philips Hue app.

Philips Hue has a SDK and even starting Java applications for both Windows and Android. These can both be found at https://github.com/PhilipsHue/PhilipsHueSDK-Java-MultiPlatform-Android. The starting app was pretty much everything I wanted so I really have to commend Philips for this. It easily handled the initial bridge connection which I was great to be able avoid so that I could immediately get to work on what I wanted to do. It took a bit of time but it was pretty clear what to do with the SDK and I quickly managed to setup the app so that when it starts up if any lights are on it turns them off otherwise it sets them to my desired colour therefore only requiring starting up the application. This isn’t exactly what I want as I am still left with the open app afterwards but I doubt that will take much more work to handle and hopefully I can make it similar to how widgets work. However now that I had something that worked I wanted to get it onto my phone rather than just the emulator.

Frustration is what I started to experience as problems kept popping up with no obvious solutions. Initially I tried plugging in my phone and using Android Studio to run it on my phone. Unfortunately it is not plug and play as I found out. After some Googling I uncovered that you needed to click the Android build number 7 times before you could enable the developer options. However this was just the start of what Android was hiding. I now had the USB debugging option in Developer options but it was greyed out and I couldn’t click on it. Eventually I found out I had to first unplug my phone before that option could be selected. Now this may indeed be an important feature for security or something but I see no reason why Android can’t give a message to let the user know this when trying to select the option when it is greyed out. Still I couldn’t run it on Android Studio and it seemed I probably needed a driver but I wasn’t sure which one I needed for my LG G3 as the LG site I was linked to sorted the software by US carriers none of which I used. But at this point I was starting to think that this may not really be the method. It was doubtful that this pretty small app would have any issues that I didn’t catch in the emulator so it was probably fine on my phone without debugging first.

Instead of continuing the debugging method I switched to exporting my app as an apk and downloading a file manager app so that I could install my app. I open up the file manager app select my apk and am given the option to “Cancel” or “Install” and what do you know but only the “Cancel” button works. This happens to be yet another place where Android implemented a security feature but completely ignored usability. After some Googling I found out that having Lux running is what caused this which I certainly would not have guessed anytime soon. Some further research and I uncovered that any brightness apps or apps that can cause any overlay on the screen will cause the “install” option to be disabled for apps as a security feature. This makes sense as apps could maliciously hide the installation permissions replacing it with something else entirely. But once again I am confounded as to why usability was seemingly ignored. When I clicked on “Install” why couldn’t I simply have gotten a message stating that I can not install this app when Lux is running a screen overlay. I can hardly imagine anyone knowing this unless they encountered it in the past.

Luckily that was the last hurdle and I had my app on my phone and it was working great. By then it had gotten late although really I started late as well. Therefore I wanted to wrap things up and check my code into Github. However without me realizing it Android had copied my files out of my Github repository location and then also reorganized the whole file structure. Since it was late I went with forgoing sophisticated version control for a quick email of the one file I edited so that I would be able to work on the project on my laptop.
